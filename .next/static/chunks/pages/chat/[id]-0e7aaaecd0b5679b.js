(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[934],{7202:function(r,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat/[id]",function(){return t(1379)}])},5483:function(r,n,t){"use strict";t.d(n,{Z:function(){return g}});var e=t(4051),o=t.n(e),i=t(5893),u=t(5684),a=t(5193),l=t(8527),c=t(9876),s=t(7263),f=t(6680),d=t(3349),h=t(6677),m=t(1294),p=t(1163);function v(r,n){(null==n||n>r.length)&&(n=r.length);for(var t=0,e=new Array(n);t<n;t++)e[t]=r[t];return e}function y(r,n,t,e,o,i,u){try{var a=r[i](u),l=a.value}catch(c){return void t(c)}a.done?n(l):Promise.resolve(l).then(e,o)}function b(r,n,t){return n in r?Object.defineProperty(r,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[n]=t,r}function x(r,n){return function(r){if(Array.isArray(r))return r}(r)||function(r,n){var t=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,o,i=[],u=!0,a=!1;try{for(t=t.call(r);!(u=(e=t.next()).done)&&(i.push(e.value),!n||i.length!==n);u=!0);}catch(l){a=!0,o=l}finally{try{u||null==t.return||t.return()}finally{if(a)throw o}}return i}}(r,n)||function(r,n){if(!r)return;if("string"===typeof r)return v(r,n);var t=Object.prototype.toString.call(r).slice(8,-1);"Object"===t&&r.constructor&&(t=r.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return v(r,n)}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(){var r=x((0,d.F_)(f.I),1)[0],n=x((0,h.Kx)((0,m.hJ)(f.db,"chats")),3),t=n[0],e=(n[1],n[2],null===t||void 0===t?void 0:t.docs.map((function(r){return function(r){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},e=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(t).filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})))),e.forEach((function(n){b(r,n,t[n])}))}return r}({id:r.id},r.data())}))),v=(0,p.useRouter)(),g=function(n){null===e||void 0===e||e.find((function(t){return t.users.includes(r.email)&&t.users.includes(n)}))},j=function(){var n,t=(n=o().mark((function n(){var t;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=prompt("Enter email of chat recipient"),g(t)||t==r.email){n.next=4;break}return n.next=4,(0,m.ET)((0,m.hJ)(f.db,"chats"),{users:[r.email,t]});case 4:case"end":return n.stop()}}),n)})),function(){var r=this,t=arguments;return new Promise((function(e,o){var i=n.apply(r,t);function u(r){y(i,e,o,u,a,"next",r)}function a(r){y(i,e,o,u,a,"throw",r)}u(void 0)}))});return function(){return t.apply(this,arguments)}}();return(0,i.jsxs)(l.kC,{h:"100%",w:"300px",borderEnd:"1px solid",borderColor:"gray.200",direction:"column",children:[(0,i.jsxs)(l.kC,{h:"81px",w:"100%",align:"center",justifyContent:"space-between",borderBottom:"1px solid",borderColor:"gray.200",p:3,children:[(0,i.jsxs)(l.kC,{align:"center",children:[(0,i.jsx)(u.qE,{src:r.photoURL,marginEnd:3}),(0,i.jsx)(l.xv,{children:r.displayName})]}),(0,i.jsx)(a.hU,{size:"sm",isRound:!0,icon:(0,i.jsx)(c.Y4,{}),onClick:function(){return(0,s.w7)(f.I)}})]}),(0,i.jsx)(a.zx,{m:5,p:4,onClick:function(){return j()},children:"New Chat"}),(0,i.jsx)(l.kC,{overflowX:"scroll",direction:"column",sx:{scrollbarWidth:"none"},flex:1,children:null===e||void 0===e?void 0:e.filter((function(n){return n.users.includes(r.email)})).map((function(n){return(0,i.jsxs)(l.kC,{p:3,align:"center",_hover:{bg:"gray.100",cursor:"pointer"},onClick:function(){return r=n.id,void v.push("/chat/".concat(r));var r},children:[(0,i.jsx)(u.qE,{src:"",marginEnd:3}),(0,i.jsx)(l.xv,{children:r.displayName})]},Math.random())}))})]})}},1379:function(r,n,t){"use strict";t.r(n),t.d(n,{default:function(){return A}});var e=t(5893),o=t(8527),i=t(5483),u=t(9008),a=t(1163),l=t(6677),c=t(3349),s=t(6257),f=t(6680),d=function(r,n){return null===r||void 0===r?void 0:r.filter((function(r){return r!==n.email}))[0]},h=t(5684);function m(r,n){(null==n||n>r.length)&&(n=r.length);for(var t=0,e=new Array(n);t<n;t++)e[t]=r[t];return e}function p(r,n){return function(r){if(Array.isArray(r))return r}(r)||function(r,n){var t=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,o,i=[],u=!0,a=!1;try{for(t=t.call(r);!(u=(e=t.next()).done)&&(i.push(e.value),!n||i.length!==n);u=!0);}catch(l){a=!0,o=l}finally{try{u||null==t.return||t.return()}finally{if(a)throw o}}return i}}(r,n)||function(r,n){if(!r)return;if("string"===typeof r)return m(r,n);var t=Object.prototype.toString.call(r).slice(8,-1);"Object"===t&&r.constructor&&(t=r.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return m(r,n)}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(r){r.email;var n=p((0,c.F_)(f.I),1)[0];return(0,e.jsxs)(o.kC,{bg:"gray.100",h:"81px",w:"100%",align:"center",p:5,children:[(0,e.jsx)(h.qE,{src:"",marginEnd:3}),(0,e.jsx)(o.X6,{size:"lg",children:n.displayName})]})}var y=t(4051),b=t.n(y),x=t(7294),g=t(9762),j=t(4612),w=t(5193);function C(r,n,t,e,o,i,u){try{var a=r[i](u),l=a.value}catch(c){return void t(c)}a.done?n(l):Promise.resolve(l).then(e,o)}function k(r){var n=r.id,t=r.user,o=(0,x.useState)(""),i=o[0],u=o[1],a=function(){var r,e=(r=b().mark((function r(e){return b().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.preventDefault(),!(i.length>0)){r.next=5;break}return r.next=4,(0,s.ET)((0,s.hJ)(f.db,"chats/".concat(n,"/messages")),{text:i,sender:t.email,timestamp:(0,s.Bt)()});case 4:u("");case 5:case"end":return r.stop()}}),r)})),function(){var n=this,t=arguments;return new Promise((function(e,o){var i=r.apply(n,t);function u(r){C(i,e,o,u,a,"next",r)}function a(r){C(i,e,o,u,a,"throw",r)}u(void 0)}))});return function(r){return e.apply(this,arguments)}}();return(0,e.jsxs)(g.NI,{p:3,onSubmit:a,as:"form",children:[(0,e.jsx)(j.II,{placeholder:"Message...",autoComplete:"off",onChange:function(r){return u(r.target.value)},value:i}),(0,e.jsx)(w.zx,{type:"submit",hidden:!0,children:"Submit"})]})}function S(r,n){(null==n||n>r.length)&&(n=r.length);for(var t=0,e=new Array(n);t<n;t++)e[t]=r[t];return e}function E(r,n){return function(r){if(Array.isArray(r))return r}(r)||function(r,n){var t=null==r?null:"undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,o,i=[],u=!0,a=!1;try{for(t=t.call(r);!(u=(e=t.next()).done)&&(i.push(e.value),!n||i.length!==n);u=!0);}catch(l){a=!0,o=l}finally{try{u||null==t.return||t.return()}finally{if(a)throw o}}return i}}(r,n)||function(r,n){if(!r)return;if("string"===typeof r)return S(r,n);var t=Object.prototype.toString.call(r).slice(8,-1);"Object"===t&&r.constructor&&(t=r.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return S(r,n)}(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(){var r=(0,a.useRouter)().query.id,n=E((0,c.F_)(f.I),1)[0],t=E((0,l.Xi)((0,s.JU)(f.db,"chats",r)),1)[0],h=(0,s.IO)((0,s.hJ)(f.db,"chats/".concat(r,"/messages")),(0,s.Xo)("timestamp")),m=E((0,l.d4)(h),1)[0],p=(0,x.useRef)();return(0,x.useEffect)((function(){return setTimeout(p.current.scrollIntoView({behavior:"smooth",block:"start"}),100)}),[m]),(0,e.jsxs)(o.kC,{h:"100vh",children:[(0,e.jsx)(u.default,{children:(0,e.jsx)("title",{children:"Chat App"})}),(0,e.jsx)(i.Z,{}),(0,e.jsxs)(o.kC,{flex:1,direction:"column",children:[(0,e.jsx)(v,{email:d(null===t||void 0===t?void 0:t.users,n)}),(0,e.jsxs)(o.kC,{flex:1,direction:"column",pt:4,mx:5,overflowX:"scroll",sx:{scrollbarWidth:"none"},children:[null===m||void 0===m?void 0:m.map((function(r){var t=r.sender===n.email;return(0,e.jsx)(o.kC,{alignSelf:t?"flex-start":"flex-end",bg:t?"blue.100":"green.100",w:"fit-content",minWidth:"100px",borderRadius:"lg",p:3,m:1,children:(0,e.jsx)(o.xv,{children:r.text})},Math.random())})),(0,e.jsx)("div",{ref:p})]}),(0,e.jsx)(k,{id:r,user:n})]})]})}}},function(r){r.O(0,[159,612,774,888,179],(function(){return n=7202,r(r.s=n);var n}));var n=r.O();_N_E=n}]);